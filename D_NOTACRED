ALTER TABLE D_NOTACRED
ADD CERTIFICADA_DGI bit NOT NULL DEFAULT 0,
	  CUFE nvarchar(150) NULL
	  
ALTER TABLE D_NOTACRED
ADD TIPO_DOCUMENTO nvarchar (10) NULL,
	COREL_REFERENCIA nvarchar(20) NULL,
	ES_ANULACION bit NULL,
	CUFE_FACTURA nvarchar(150) NULL

update D_NOTACRED set TIPO_DOCUMENTO = '' where TIPO_DOCUMENTO is null

alter table d_notacred alter column TIPO_DOCUMENTO nvarchar(10) not null

alter table d_notacredd add TIPO_DOCUMENTO nvarchar(10) not null default ''

ALTER TABLE [dbo].[D_NOTACREDD] DROP CONSTRAINT [FK_D_NOTACREDD_D_NOTACRED]
GO

/****** Object:  Index [PK_D_NOTACRED]    Script Date: 31/01/2023 17:47:18 ******/
ALTER TABLE [dbo].[D_NOTACRED] DROP CONSTRAINT [PK_D_NOTACRED] WITH ( ONLINE = OFF )
GO

SET ANSI_PADDING ON
GO

/****** Object:  Index [PK_D_NOTACRED]    Script Date: 31/01/2023 17:47:18 ******/
ALTER TABLE [dbo].[D_NOTACRED] ADD  CONSTRAINT [PK_D_NOTACRED] PRIMARY KEY CLUSTERED 
(
	[COREL] ASC, 
	[TIPO_DOCUMENTO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
GO 

ALTER TABLE [dbo].[D_NOTACREDD]  WITH NOCHECK ADD  CONSTRAINT [FK_D_NOTACREDD_D_NOTACRED] FOREIGN KEY([COREL], [TIPO_DOCUMENTO])
REFERENCES [dbo].[D_NOTACRED] ([COREL], [TIPO_DOCUMENTO])
ON DELETE CASCADE
GO 

ALTER TABLE [dbo].[D_NOTACREDD] CHECK CONSTRAINT [FK_D_NOTACREDD_D_NOTACRED]
GO

/****** Object:  Index [PK_D_NOTACREDD]    Script Date: 31/01/2023 18:13:03 ******/
ALTER TABLE [dbo].[D_NOTACREDD] DROP CONSTRAINT [PK_D_NOTACREDD] WITH ( ONLINE = OFF )
GO

SET ANSI_PADDING ON
GO

/****** Object:  Index [PK_D_NOTACREDD]    Script Date: 31/01/2023 18:13:03 ******/
ALTER TABLE [dbo].[D_NOTACREDD] ADD  CONSTRAINT [PK_D_NOTACREDD] PRIMARY KEY CLUSTERED 
(
	[COREL] ASC,
	[PRODUCTO] ASC, 
	[TIPO_DOCUMENTO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
GO
